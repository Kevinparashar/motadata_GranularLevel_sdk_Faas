"""
Configuration Management

Handles configuration for the use case.
"""

import os
from typing import Optional
from pydantic import BaseModel, Field
from dotenv import load_dotenv

load_dotenv()


class DatabaseConfig(BaseModel):
    """Database configuration."""
    host: str = Field(default="localhost", env="POSTGRES_HOST")
    port: int = Field(default=5432, env="POSTGRES_PORT")
    database: str = Field(default="motadata_sdk", env="POSTGRES_DB")
    user: str = Field(default="postgres", env="POSTGRES_USER")
    password: str = Field(default="", env="POSTGRES_PASSWORD")


class GatewayConfig(BaseModel):
    """Gateway configuration."""
    api_key: Optional[str] = Field(default=None, env="OPENAI_API_KEY")
    provider: str = Field(default="openai", env="LLM_PROVIDER")
    model: str = Field(default="gpt-4", env="LLM_MODEL")
    embedding_model: str = Field(default="text-embedding-3-small", env="EMBEDDING_MODEL")


class CacheConfig(BaseModel):
    """Cache configuration."""
    backend: str = Field(default="memory", env="CACHE_BACKEND")
    redis_host: Optional[str] = Field(default=None, env="REDIS_HOST")
    redis_port: int = Field(default=6379, env="REDIS_PORT")


class Config(BaseModel):
    """Main configuration."""
    database: DatabaseConfig = Field(default_factory=DatabaseConfig)
    gateway: GatewayConfig = Field(default_factory=GatewayConfig)
    cache: CacheConfig = Field(default_factory=CacheConfig)
    environment: str = Field(default="development", env="ENVIRONMENT")
    debug: bool = Field(default=False, env="DEBUG")
    
    class Config:
        env_file = ".env"
        env_file_encoding = "utf-8"

